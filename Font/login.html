<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EaseEat</title>

    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏° favicon -->
    <link rel="icon" href="Img/LOGO.png" type="image/x-icon">
    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏≠‡∏ô‡∏ï‡πå Lato Bold ‡∏à‡∏≤‡∏Å Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@700&display=swap" rel="stylesheet">
    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏° Font Awesome CDN -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå CSS -->
    <link href="css/Header_Footer.css" rel="stylesheet">
    <link href="css/login.css" rel="stylesheet">



</head>

<body>
    <!-- Header Start -->
    <div class="container-fluid nav-bar px-0 px-lg-4 py-lg-0">
        <div class="container">
            <nav class="navbar navbar-expand-lg navbar-light">
                <a class="navbar-brand" href="Home.html">
                    <img src="Img/LOGO.png" alt="Logo">
                    <h1>EASEEAT</h1>
                </a>

                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <div class="navbar-nav ms-auto">
                        <a href="Home.html" class="nav-item nav-link active">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
                        <a href="InstructionsForm.html" class="nav-item nav-link">‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</a>
                        <a href="community.html" class="nav-item nav-link">‡∏ä‡∏∏‡∏°‡∏ä‡∏ô</a>
                        <a href="Nutrients.html" class="nav-item nav-link">‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£</a>
                        <a id="nav-login" href="login.html" class="nav-item nav-link">Login</a>
                        <a id="logout" href="#" class="nav-item nav-link" style="display: none;">Logout</a>
                    </div>
                </div>
            </nav>
        </div>
    </div>
    <!-- Header End -->


    <!-- Login Form Start -->
    <div class="login-container">
        <div class="login-box">
            <h2>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà LOGIN</h2>
            <div id="error-message" class="error-message" style="display: none; color: red;"></div>
            <form id="login-form" onsubmit="return loginUser(event);">
                <div class="input-field">
                    <span class="icon">üë§</span>
                    <input type="text" name="Username" placeholder="Username" required>
                </div>
                <div class="input-field">
                    <span class="icon">üîí</span>
                    <input type="password" name="password" placeholder="Password" required>
                </div>
                <button type="submit" class="login-button">Login</button>
                <div class="options">
                    <a href="#">‡∏•‡∏∑‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</a> | <a href="register.html">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</a>
                </div>
            </form>
        </div>
    </div>
    <!-- Login Form End -->

    <script>
        async function loginUser(event) {
            event.preventDefault();

            const username = document.querySelector("input[name='Username']").value.trim();
            const password = document.querySelector("input[name='password']").value.trim();
            const errorMessage = document.getElementById("error-message");

            errorMessage.style.display = "none";

            try {
                const response = await fetch("http://localhost:8080/api/users/login", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ username, password }),
                });

                if (response.ok) {
                    const userData = await response.json();
                    alert("‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");

                    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å userId ‡πÅ‡∏•‡∏∞ username ‡πÉ‡∏ô Local Storage
                    localStorage.setItem("userId", userData.id); // ‡πÄ‡∏Å‡πá‡∏ö id
                    localStorage.setItem("userId", userData.id); // ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ id ‡πÉ‡∏ô response
                    localStorage.setItem("username", userData.name || username);

                    // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏õ‡∏¢‡∏±‡∏á Home
                    window.location.href = "Home.html";
                } else {
                    const message = await response.text();
                    errorMessage.textContent = "‚ùå " + message;
                    errorMessage.style.display = "block";
                }
            } catch (error) {
                errorMessage.textContent = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + error.message;
                errorMessage.style.display = "block";
            }
        }



    </script>



    <!-- Footer Start -->
    <div class="container-fluid footer py-5">
        <div class="container">
            <div class="row">
                <!-- Footer Left Section -->
                <div class="col-md-4 footer-item">
                    <a href="index.html" class="p-0">
                        <img src="Img/LOGO.png" alt="Logo" style="height: 60px;">
                        <h3 class="text-white"><i class="fab fa-slack me-3"></i> EASEEAT</h3>
                    </a>
                    <p class="text-white mb-4">‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏î‡πå‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÉ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏à‡∏¥‡∏ï
                        ‡πÇ‡∏î‡∏¢‡∏ô‡∏±‡∏Å‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏à‡∏¥‡∏ï‡πÅ‡∏û‡∏ó‡∏¢‡πå</p>
                </div>
                <!-- Footer Center Section -->
                <div class="col-md-4 footer-item text-center">
                    <h4 class="text-white mb-4">Our Services</h4>
                    <ul class="list-unstyled">
                        <li><a href="form.html" class="text-white"><i class="fas fa-angle-right me-2"></i> ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</a>
                        </li>
                        <li><a href="community.html" class="text-white"><i class="fas fa-angle-right me-2"></i>
                                ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô</a>
                        </li>
                        <li><a href="Nutrients.html" class="text-white"><i class="fas fa-angle-right me-2"></i>
                                ‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£</a>
                        </li>
                        <li><a href="#" class="text-white"><i class="fas fa-angle-right me-2"></i> ‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</a>
                        </li>
                    </ul>
                </div>
                <!-- Footer Right Section -->
                <div class="col-md-4 footer-item text-end">
                    <h4 class="text-white mb-4">Follow Us</h4>
                    <ul class="list-unstyled d-flex justify-content-end">
                        <li class="me-4">
                            <a href="#" class="text-white social-icon">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                        </li>
                        <li class="me-4">
                            <a href="#" class="text-white social-icon">
                                <i class="fab fa-instagram"></i>
                            </a>
                        </li>
                        <li>
                            <a href="#" class="text-white social-icon">
                                <i class="fab fa-google"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- Copyright Section -->
            <div class="row mt-4">
                <div class="col-12 text-center">
                    <p class="text-white mb-0">¬© 2024 EaseEat. All rights reserved.</p>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer End -->
    <script type="module" src="Js/auth.js"></script>
</body>

</html>